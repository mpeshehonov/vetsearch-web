-- Проверяем и добавляем тестовые данные для ветеринарной клиники

-- Добавляем владельцев животных (если их нет)
INSERT INTO pet_owners (id, full_name, email, phone, address, emergency_contact, notes, created_at, updated_at)
VALUES 
  ('550e8400-e29b-41d4-a716-446655440001', 'Иванова Мария Петровна', 'maria.ivanova@email.com', '+7 (495) 123-45-67', 'г. Москва, ул. Ленина, д. 10, кв. 25', '+7 (495) 987-65-43', 'Постоянный клиент, предпочитает утренние приемы', NOW(), NOW()),
  ('550e8400-e29b-41d4-a716-446655440002', 'Петров Алексей Сергеевич', 'alex.petrov@email.com', '+7 (495) 234-56-78', 'г. Москва, пр. Мира, д. 45, кв. 12', '+7 (495) 876-54-32', 'Владелец двух кошек', NOW(), NOW()),
  ('550e8400-e29b-41d4-a716-446655440003', 'Сидорова Елена Владимировна', 'elena.sidorova@email.com', '+7 (495) 345-67-89', 'г. Москва, ул. Гагарина, д. 78, кв. 5', '+7 (495) 765-43-21', 'Нервничает во время приемов', NOW(), NOW()),
  ('550e8400-e29b-41d4-a716-446655440004', 'Козлов Дмитрий Николаевич', 'dmitry.kozlov@email.com', '+7 (495) 456-78-90', 'г. Москва, ул. Пушкина, д. 33, кв. 18', '+7 (495) 654-32-10', 'Владелец собаки крупной породы', NOW(), NOW())
ON CONFLICT (id) DO NOTHING;

-- Добавляем животных (если их нет)
INSERT INTO pets (id, name, species, breed, birth_date, gender, weight, color, microchip_number, allergies, medical_notes, owner_id, is_active, created_at, updated_at)
VALUES 
  ('660e8400-e29b-41d4-a716-446655440001', 'Мурка', 'Кошка', 'Британская короткошерстная', '2020-03-15', 'Женский', 4.2, 'Серый', '123456789012345', 'Аллергия на курицу', 'Стерилизована в 2021 году', '550e8400-e29b-41d4-a716-446655440001', true, NOW(), NOW()),
  ('660e8400-e29b-41d4-a716-446655440002', 'Барсик', 'Кот', 'Мейн-кун', '2019-07-22', 'Мужской', 6.8, 'Рыжий', '234567890123456', NULL, 'Кастрирован, склонен к перееданию', '550e8400-e29b-41d4-a716-446655440002', true, NOW(), NOW()),
  ('660e8400-e29b-41d4-a716-446655440003', 'Белка', 'Кошка', 'Сиамская', '2021-11-08', 'Женский', 3.5, 'Кремовый с темными отметинами', '345678901234567', 'Чувствительность к анестезии', 'Очень активная, любит играть', '550e8400-e29b-41d4-a716-446655440002', true, NOW(), NOW()),
  ('660e8400-e29b-41d4-a716-446655440004', 'Рекс', 'Собака', 'Немецкая овчарка', '2018-05-10', 'Мужской', 32.0, 'Черно-коричневый', '456789012345678', NULL, 'Дрессированная собака, спокойная', '550e8400-e29b-41d4-a716-446655440004', true, NOW(), NOW()),
  ('660e8400-e29b-41d4-a716-446655440005', 'Лола', 'Собака', 'Йоркширский терьер', '2022-01-20', 'Женский', 2.1, 'Коричневый с черным', '567890123456789', 'Аллергия на говядину', 'Миниатюрная, требует деликатного обращения', '550e8400-e29b-41d4-a716-446655440003', true, NOW(), NOW())
ON CONFLICT (id) DO NOTHING;

-- Добавляем услуги (если их нет)
INSERT INTO services (id, name, description, price, duration_minutes, category, is_active, created_at)
VALUES 
  ('770e8400-e29b-41d4-a716-446655440001', 'Общий осмотр', 'Комплексный осмотр животного с оценкой общего состояния здоровья', 1500.00, 30, 'Диагностика', true, NOW()),
  ('770e8400-e29b-41d4-a716-446655440002', 'Вакцинация комплексная', 'Комплексная вакцинация против основных заболеваний', 2500.00, 20, 'Профилактика', true, NOW()),
  ('770e8400-e29b-41d4-a716-446655440003', 'Стерилизация кошки', 'Хирургическая стерилизация кошки с анестезией', 8000.00, 90, 'Хирургия', true, NOW()),
  ('770e8400-e29b-41d4-a716-446655440004', 'Кастрация кота', 'Хирургическая кастрация кота с анестезией', 5000.00, 45, 'Хирургия', true, NOW()),
  ('770e8400-e29b-41d4-a716-446655440005', 'УЗИ брюшной полости', 'Ультразвуковое исследование органов брюшной полости', 3000.00, 40, 'Диагностика', true, NOW()),
  ('770e8400-e29b-41d4-a716-446655440006', 'Чистка зубов', 'Профессиональная чистка зубов с удалением зубного камня', 4500.00, 60, 'Стоматология', true, NOW()),
  ('770e8400-e29b-41d4-a716-446655440007', 'Рентген', 'Рентгенологическое исследование', 2800.00, 25, 'Диагностика', true, NOW()),
  ('770e8400-e29b-41d4-a716-446655440008', 'Анализ крови общий', 'Общий клинический анализ крови', 1200.00, 15, 'Лабораторные исследования', true, NOW())
ON CONFLICT (id) DO NOTHING;

-- Добавляем профили пользователей (эти записи будут созданы после регистрации пользователей)
-- Сначала пользователи должны зарегистрироваться через форму, затем их профили будут обновлены

-- Добавляем тестовые записи на прием
INSERT INTO appointments (id, pet_id, veterinarian_id, service_id, appointment_date, appointment_time, duration_minutes, status, reason, diagnosis, treatment, notes, total_cost, follow_up_needed, follow_up_date, created_at, updated_at)
VALUES 
  ('880e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440001', (SELECT id FROM profiles WHERE email = 'dr.ivanova@vetclinic.com' LIMIT 1), '770e8400-e29b-41d4-a716-446655440001', CURRENT_DATE + INTERVAL '1 day', '10:00:00', 30, 'Запланирована', 'Плановый осмотр', NULL, NULL, 'Первичный прием нового пациента', 1500.00, false, NULL, NOW(), NOW()),
  ('880e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440004', (SELECT id FROM profiles WHERE email = 'dr.petrov@vetclinic.com' LIMIT 1), '770e8400-e29b-41d4-a716-446655440002', CURRENT_DATE + INTERVAL '2 days', '14:30:00', 20, 'Запланирована', 'Вакцинация', NULL, NULL, 'Ежегодная комплексная вакцинация', 2500.00, true, CURRENT_DATE + INTERVAL '30 days', NOW(), NOW()),
  ('880e8400-e29b-41d4-a716-446655440003', '660e8400-e29b-41d4-a716-446655440002', (SELECT id FROM profiles WHERE email = 'dr.sidorova@vetclinic.com' LIMIT 1), '770e8400-e29b-41d4-a716-446655440005', CURRENT_DATE, '16:00:00', 40, 'В процессе', 'Проблемы с пищеварением', 'Гастрит', 'Диетотерапия, пробиотики', 'Назначена специальная диета на 2 недели', 3000.00, true, CURRENT_DATE + INTERVAL '14 days', NOW(), NOW())
ON CONFLICT (id) DO NOTHING;

-- Добавляем медицинские записи
INSERT INTO medical_records (id, pet_id, appointment_id, veterinarian_id, record_date, record_type, title, description, medications, attachments, next_visit_date, created_at)
VALUES 
  ('990e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440001', '880e8400-e29b-41d4-a716-446655440003', (SELECT id FROM profiles WHERE email = 'dr.sidorova@vetclinic.com' LIMIT 1), CURRENT_DATE, 'Диагноз', 'Гастрит у кота Барсика', 'Обнаружены признаки воспаления слизистой желудка. Рекомендована диетотерапия и медикаментозное лечение.', 'Омепразол 10мг 1 раз в день, Пробиотики 2 раза в день', '[]', CURRENT_DATE + INTERVAL '14 days', NOW()),
  ('990e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440005', NULL, (SELECT id FROM profiles WHERE email = 'dr.ivanova@vetclinic.com' LIMIT 1), CURRENT_DATE - INTERVAL '30 days', 'Вакцинация', 'Первичная вакцинация щенка', 'Проведена первичная комплексная вакцинация. Животное перенесло процедуру хорошо.', 'Нобивак DHPPi', '[]', CURRENT_DATE + INTERVAL '21 days', NOW())
ON CONFLICT (id) DO NOTHING;
